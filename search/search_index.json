{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"SC945D - \u00c9cran Tactile Domotique","text":"<p>Bienvenue dans la documentation technique du module SC945D. Ce projet s'inscrit dans l'initiative Open Source Hardware d'Essensys.</p> <p>Le SC945D est une interface utilisateur tactile compacte destin\u00e9e au pilotage de la domotique.</p>"},{"location":"#apercu-schema-electronique","title":"Aper\u00e7u - Sch\u00e9ma \u00c9lectronique","text":"<p>Voir le sch\u00e9ma complet (PDF)</p>"},{"location":"#apercu-assemblage","title":"Aper\u00e7u - Assemblage","text":""},{"location":"#documentation","title":"Documentation","text":"<p>Explorez les d\u00e9tails techniques du module :</p> <ul> <li>\ud83c\udfdb\ufe0f Architecture - Vue d'ensemble du syst\u00e8me.</li> <li>\ud83d\udd0c Hardware - D\u00e9tails des composants et PCB.</li> <li>\ud83d\udcbe T\u00e9l\u00e9chargements - Fichiers sources et fabrication.</li> <li>\ud83d\udcbb Firmware - Logiciel embarqu\u00e9 et PICASO-GFX2.</li> <li>\ud83e\udde0 Analyse Logicielle - Algorithmes et architecture modulaire (Mermaid).</li> </ul>"},{"location":"architecture/","title":"Architecture Syst\u00e8me","text":"<p>Vue d'ensemble de l'int\u00e9gration du SC945D dans l'\u00e9cosyst\u00e8me Essensys.</p>"},{"location":"architecture/#diagramme-fonctionnel","title":"Diagramme fonctionnel","text":"<p>(Ins\u00e9rer diagramme mermaid ou image ici)</p>"},{"location":"architecture/#role-dans-la-domotique","title":"R\u00f4le dans la Domotique","text":"<p>Le SC945D agit comme un point de contr\u00f4le local, permettant \u00e0 l'utilisateur d'interagir avec les lumi\u00e8res, volets, et sc\u00e9narios.</p>"},{"location":"downloads/","title":"T\u00e9l\u00e9chargements","text":"<p>Retrouvez ici tous les fichiers sources pour la fabrication et l'\u00e9tude du module SC945D.</p> Type Description Lien \ud83d\udcc2 Sch\u00e9ma Sch\u00e9matique complet du circuit SC945D_Schematic.pdf \ud83d\udce6 Mod\u00e8le 3D Fichier STEP pour l'int\u00e9gration m\u00e9canique SC945D.step \ud83c\udfed Fabrication Archives Gerber pour la production PCB SC945D_Gerbers.zip \ud83d\udee0\ufe0f Assemblage Plans d'assemblage Assembly.pdf"},{"location":"firmware/","title":"Firmware SC945D","text":""},{"location":"firmware/#contexte","title":"Contexte","text":"<p>Le SC945D est un module d'interface utilisateur pour le syst\u00e8me domotique Essensys. Il est \u00e9quip\u00e9 d'un \u00e9cran tactile gest\u00e9 par le puissant contr\u00f4leur graphique 4D Systems PICASO-GFX2.</p>"},{"location":"firmware/#environnement-de-build","title":"Environnement de Build","text":"<p>(\u00c0 compl\u00e9ter : Version IDE, Compilateur, Outils 4D Systems Workshop4)</p>"},{"location":"firmware/#architecture-logicielle","title":"Architecture Logicielle","text":"<p>Le firmware repose sur l'interaction entre le MCU h\u00f4te et le contr\u00f4leur PICASO-GFX2.</p>"},{"location":"firmware/#gestion-de-laffichage-picaso-gfx2","title":"Gestion de l'Affichage (PICASO-GFX2)","text":"<p>L'interface graphique est propuls\u00e9e par le processeur PICASO. La communication se fait g\u00e9n\u00e9ralement via un bus s\u00e9rie (UART).</p>"},{"location":"firmware/#protocole-de-communication","title":"Protocole de Communication","text":"<p>Le SC945D communique avec les autres cartes du syst\u00e8me (SC940, SC941, etc.) et potentiellement le serveur central.  (D\u00e9tails du protocole \u00e0 documenter ici)</p>"},{"location":"firmware/#algorithme-de-demarrage","title":"Algorithme de D\u00e9marrage","text":"<ol> <li>Initialisation Hardware : Configuration des pins, clocks, et p\u00e9riph\u00e9riques.</li> <li>Initialisation \u00c9cran : S\u00e9quence de d\u00e9marrage du PICASO-GFX2.</li> <li>V\u00e9rification Communication : Ping des autres modules.</li> <li>Boucle Principale : Gestion des \u00e9v\u00e9nements tactiles et mise \u00e0 jour de l'affichage.</li> </ol>"},{"location":"firmware_logic/","title":"Logique du Firmware SC945D","text":""},{"location":"firmware_logic/#vue-densemble","title":"Vue d'Ensemble","text":"<p>Le firmware du SC945D est d\u00e9velopp\u00e9 en 4DGL (4D Graphics Language) pour le processeur PICASO-GFX2 de 4D Systems. Il adopte une architecture modulaire unique pour contourner les limitations de m\u00e9moire flash interne en utilisant la carte uSD comme stockage de programme \u00e9tendu.</p>"},{"location":"firmware_logic/#architecture-modulaire","title":"Architecture Modulaire","text":"<pre><code>graph TD\n    subgraph \"Flash Interne (PICASO)\"\n        Main[_Main.4Xe]\n    end\n\n    subgraph \"Carte uSD (FAT16)\"\n        Func1[Home.4FN]\n        Func2[Setup.4FN]\n        Func3[Alarme.4FN]\n        Assets[Images / .Gci]\n    end\n\n    Main -- \"file_LoadFunction()\" --&gt; RAM[RAM du Processeur]\n    Func1 -.-&gt; RAM\n    Func2 -.-&gt; RAM\n    RAM -- \"Ex\u00e9cution\" --&gt; Display[Affichage]</code></pre> <p>Le syst\u00e8me est divis\u00e9 en deux parties : 1.  Le Noyau (<code>_Main.4dg</code>) : Un programme r\u00e9sident en m\u00e9moire Flash qui initialise le mat\u00e9riel et agit comme un ordonnanceur (scheduler). 2.  Les Applications (<code>*.4FN</code>) : Des modules fonctionnels ind\u00e9pendants stock\u00e9s sur la carte uSD et charg\u00e9s dynamiquement en RAM.</p>"},{"location":"firmware_logic/#avantages","title":"Avantages","text":"<ul> <li>Modularit\u00e9 : Chaque \u00e9cran ou fonctionnalit\u00e9 est un fichier s\u00e9par\u00e9.</li> <li>Extensibilit\u00e9 : La taille du programme n'est limit\u00e9e que par la capacit\u00e9 de la carte SD, pas par la flash du processeur.</li> <li>Mise \u00e0 jour : Il est possible de mettre \u00e0 jour une seule fonction en rempla\u00e7ant son fichier <code>.4FN</code> sur la carte SD.</li> </ul>"},{"location":"firmware_logic/#algorithme-principal-_main4dg","title":"Algorithme Principal (<code>_Main.4dg</code>)","text":"<p>Le fichier <code>SC945D/Prog/Main 1.0/_Main.4dg</code> est le point d'entr\u00e9e. Son cycle de vie est le suivant :</p> <pre><code>flowchart TD\n    Start((D\u00e9marrage)) --&gt; Init[Initialisation Hardware]\n    Init --&gt; CheckSD{uSD Pr\u00e9sente ?}\n    CheckSD -- Non --&gt; Wait[Attente uSD]\n    Wait --&gt; CheckSD\n    CheckSD -- Oui --&gt; Loop(Boucle Principale)\n\n    Loop --&gt; CheckState{\u00c9tat 'Ecran' ?}\n\n    CheckState -- ECRAN_HOME --&gt; LoadHome[Charger 'Home.4FN']\n    CheckState -- ECRAN_SETUP --&gt; LoadSetup[Charger 'Setup.4FN']\n    CheckState -- ... --&gt; LoadOther[...]\n\n    LoadHome --&gt; Exec[Ex\u00e9cuter Fonction]\n    LoadSetup --&gt; Exec\n    LoadOther --&gt; Exec\n\n    Exec --&gt; NewState[Retour Nouvel \u00c9tat]\n    NewState --&gt; Free[Lib\u00e9rer M\u00e9moire]\n    Free --&gt; UpdateState[Mise \u00e0 jour 'Ecran']\n    UpdateState --&gt; Loop</code></pre>"},{"location":"firmware_logic/#1-initialisation","title":"1. Initialisation","text":"<p>Au d\u00e9marrage, le <code>main()</code> effectue les configurations mat\u00e9rielles : *   I/O : Configuration du switch d'ouverture (Pin 3). *   Audio : Volume au maximum (<code>snd_Volume(127)</code>). *   Tactile : Activation de la dalle r\u00e9sistive (<code>touch_Set(0)</code>). *   S\u00e9rie : Configuration du port COM0 \u00e0 9600 bauds pour la communication avec le reste du syst\u00e8me. *   Stockage : Montage du syst\u00e8me de fichiers FAT16 de la carte uSD (<code>file_Mount()</code>). Si la carte est absente, le syst\u00e8me attend.</p>"},{"location":"firmware_logic/#2-boucle-infinie-scheduler","title":"2. Boucle Infinie (Scheduler)","text":"<p>Le programme entre dans une boucle <code>forever</code> qui surveille la variable globale <code>Ecran</code>. Pour chaque \u00e9tat possible de <code>Ecran</code>, le scheduler : 1.  Charge la fonction correspondante depuis la SD : <code>f_Ecran_ptr := file_LoadFunction(\"NomFichier.4FN\");</code> 2.  Ex\u00e9cute la fonction en lui passant les buffers de communication et param\u00e8tres : <code>Ecran := f_Ecran_ptr(...);</code> 3.  Lib\u00e8re la m\u00e9moire une fois la fonction termin\u00e9e : <code>mem_Free(f_Ecran_ptr);</code></p> <p>La fonction appel\u00e9e g\u00e8re l'interface utilisateur pour cet \u00e9cran sp\u00e9cifique et retourne la valeur du prochain \u00e9cran \u00e0 afficher, ce qui pilote la machine \u00e0 \u00e9tat.</p>"},{"location":"firmware_logic/#compilation-et-deploiement","title":"Compilation et D\u00e9ploiement","text":""},{"location":"firmware_logic/#environnement","title":"Environnement","text":"<ul> <li>IDE : 4D Workshop 4 IDE.</li> <li>Langage : 4DGL (proche du C).</li> <li>Plateforme : uLCD-28PT (PICASO).</li> </ul>"},{"location":"firmware_logic/#processus-de-build","title":"Processus de Build","text":"<p>La compilation g\u00e9n\u00e8re plusieurs types de fichiers : *   <code>.4XE</code> : Ex\u00e9cutable principal (pour la Flash). *   <code>.4FN</code> : Fonctions compil\u00e9es (pour la uSD). *   <code>.Gci</code> / <code>.Dat</code> : Assets graphiques (Images, Ic\u00f4nes).</p>"},{"location":"firmware_logic/#mise-en-production","title":"Mise en Production","text":"<p>Pour d\u00e9ployer le firmware sur un \u00e9cran : 1.  Flasher le <code>_Main.4Xe</code> via l'IDE et le c\u00e2ble de programmation 4D Systems. 2.  Copier tous les fichiers <code>.4FN</code>, <code>.Gci</code>, et <code>.Dat</code> sur la racine de la carte uSD. 3.  Le script <code>SC945D/Prog/uSD IHM 2.0/_Copy_uSD_Prod_7 (D).bat</code> est fourni pour automatiser la copie des fichiers n\u00e9cessaires vers le lecteur <code>D:</code>.</p>"},{"location":"hardware/","title":"Hardware","text":"<p>Cette section d\u00e9taillera la conception mat\u00e9rielle du SC945D.</p>"},{"location":"hardware/#composants-cles","title":"Composants Cl\u00e9s","text":"<ul> <li>Contr\u00f4leur Graphique : 4D Systems PICASO-GFX2</li> <li>MCU : (\u00c0 pr\u00e9ciser)</li> <li>\u00c9cran : TFT Tactile 2.8\"</li> </ul>"},{"location":"hardware/#pcb","title":"PCB","text":"<p>(Images du routage ou stackup \u00e0 ajouter)</p>"}]}